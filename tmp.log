
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
pointllm 0.1.2 requires tokenizers==0.12.1, but you have tokenizers 0.21.1 which is incompatible.





Some weights of PointLLMLlamaForCausalLM were not initialized from the model checkpoint at checkpoints/Qwen2.5-VL-3B-Instruct and are newly initialized: 
['model.point_backbone.blocks.blocks.0.attn.proj.bias', 'model.point_backbone.blocks.blocks.0.attn.proj.weight', 'model.point_backbone.blocks.blocks.0.attn.qkv.weight', 'model.point_backbone.blocks.blocks.0.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.0.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.0.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.0.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.0.norm1.bias', 'model.point_backbone.blocks.blocks.0.norm1.weight', 'model.point_backbone.blocks.blocks.0.norm2.bias', 'model.point_backbone.blocks.blocks.0.norm2.weight', 'model.point_backbone.blocks.blocks.1.attn.proj.bias', 'model.point_backbone.blocks.blocks.1.attn.proj.weight', 'model.point_backbone.blocks.blocks.1.attn.qkv.weight', 'model.point_backbone.blocks.blocks.1.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.1.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.1.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.1.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.1.norm1.bias', 'model.point_backbone.blocks.blocks.1.norm1.weight', 'model.point_backbone.blocks.blocks.1.norm2.bias', 'model.point_backbone.blocks.blocks.1.norm2.weight', 'model.point_backbone.blocks.blocks.10.attn.proj.bias', 'model.point_backbone.blocks.blocks.10.attn.proj.weight', 'model.point_backbone.blocks.blocks.10.attn.qkv.weight', 'model.point_backbone.blocks.blocks.10.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.10.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.10.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.10.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.10.norm1.bias', 'model.point_backbone.blocks.blocks.10.norm1.weight', 'model.point_backbone.blocks.blocks.10.norm2.bias', 'model.point_backbone.blocks.blocks.10.norm2.weight', 'model.point_backbone.blocks.blocks.11.attn.proj.bias', 'model.point_backbone.blocks.blocks.11.attn.proj.weight', 'model.point_backbone.blocks.blocks.11.attn.qkv.weight', 'model.point_backbone.blocks.blocks.11.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.11.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.11.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.11.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.11.norm1.bias', 'model.point_backbone.blocks.blocks.11.norm1.weight', 'model.point_backbone.blocks.blocks.11.norm2.bias', 'model.point_backbone.blocks.blocks.11.norm2.weight', 'model.point_backbone.blocks.blocks.2.attn.proj.bias', 'model.point_backbone.blocks.blocks.2.attn.proj.weight', 'model.point_backbone.blocks.blocks.2.attn.qkv.weight', 'model.point_backbone.blocks.blocks.2.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.2.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.2.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.2.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.2.norm1.bias', 'model.point_backbone.blocks.blocks.2.norm1.weight', 'model.point_backbone.blocks.blocks.2.norm2.bias', 'model.point_backbone.blocks.blocks.2.norm2.weight', 'model.point_backbone.blocks.blocks.3.attn.proj.bias', 'model.point_backbone.blocks.blocks.3.attn.proj.weight', 'model.point_backbone.blocks.blocks.3.attn.qkv.weight', 'model.point_backbone.blocks.blocks.3.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.3.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.3.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.3.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.3.norm1.bias', 'model.point_backbone.blocks.blocks.3.norm1.weight', 'model.point_backbone.blocks.blocks.3.norm2.bias', 'model.point_backbone.blocks.blocks.3.norm2.weight', 'model.point_backbone.blocks.blocks.4.attn.proj.bias', 'model.point_backbone.blocks.blocks.4.attn.proj.weight', 'model.point_backbone.blocks.blocks.4.attn.qkv.weight', 'model.point_backbone.blocks.blocks.4.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.4.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.4.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.4.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.4.norm1.bias', 'model.point_backbone.blocks.blocks.4.norm1.weight', 'model.point_backbone.blocks.blocks.4.norm2.bias', 'model.point_backbone.blocks.blocks.4.norm2.weight', 'model.point_backbone.blocks.blocks.5.attn.proj.bias', 'model.point_backbone.blocks.blocks.5.attn.proj.weight', 'model.point_backbone.blocks.blocks.5.attn.qkv.weight', 'model.point_backbone.blocks.blocks.5.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.5.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.5.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.5.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.5.norm1.bias', 'model.point_backbone.blocks.blocks.5.norm1.weight', 'model.point_backbone.blocks.blocks.5.norm2.bias', 'model.point_backbone.blocks.blocks.5.norm2.weight', 'model.point_backbone.blocks.blocks.6.attn.proj.bias', 'model.point_backbone.blocks.blocks.6.attn.proj.weight', 'model.point_backbone.blocks.blocks.6.attn.qkv.weight', 'model.point_backbone.blocks.blocks.6.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.6.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.6.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.6.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.6.norm1.bias', 'model.point_backbone.blocks.blocks.6.norm1.weight', 'model.point_backbone.blocks.blocks.6.norm2.bias', 'model.point_backbone.blocks.blocks.6.norm2.weight', 'model.point_backbone.blocks.blocks.7.attn.proj.bias', 'model.point_backbone.blocks.blocks.7.attn.proj.weight', 'model.point_backbone.blocks.blocks.7.attn.qkv.weight', 'model.point_backbone.blocks.blocks.7.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.7.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.7.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.7.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.7.norm1.bias', 'model.point_backbone.blocks.blocks.7.norm1.weight', 'model.point_backbone.blocks.blocks.7.norm2.bias', 'model.point_backbone.blocks.blocks.7.norm2.weight', 'model.point_backbone.blocks.blocks.8.attn.proj.bias', 'model.point_backbone.blocks.blocks.8.attn.proj.weight', 'model.point_backbone.blocks.blocks.8.attn.qkv.weight', 'model.point_backbone.blocks.blocks.8.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.8.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.8.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.8.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.8.norm1.bias', 'model.point_backbone.blocks.blocks.8.norm1.weight', 'model.point_backbone.blocks.blocks.8.norm2.bias', 'model.point_backbone.blocks.blocks.8.norm2.weight', 'model.point_backbone.blocks.blocks.9.attn.proj.bias', 'model.point_backbone.blocks.blocks.9.attn.proj.weight', 'model.point_backbone.blocks.blocks.9.attn.qkv.weight', 'model.point_backbone.blocks.blocks.9.mlp.fc1.bias', 'model.point_backbone.blocks.blocks.9.mlp.fc1.weight', 'model.point_backbone.blocks.blocks.9.mlp.fc2.bias', 'model.point_backbone.blocks.blocks.9.mlp.fc2.weight', 'model.point_backbone.blocks.blocks.9.norm1.bias', 'model.point_backbone.blocks.blocks.9.norm1.weight', 'model.point_backbone.blocks.blocks.9.norm2.bias', 'model.point_backbone.blocks.blocks.9.norm2.weight', 'model.point_backbone.cls_pos', 'model.point_backbone.cls_token', 'model.point_backbone.encoder.first_conv.0.bias', 'model.point_backbone.encoder.first_conv.0.weight', 'model.point_backbone.encoder.first_conv.1.bias', 'model.point_backbone.encoder.first_conv.1.num_batches_tracked', 'model.point_backbone.encoder.first_conv.1.running_mean', 'model.point_backbone.encoder.first_conv.1.running_var', 'model.point_backbone.encoder.first_conv.1.weight', 'model.point_backbone.encoder.first_conv.3.bias', 'model.point_backbone.encoder.first_conv.3.weight', 'model.point_backbone.encoder.second_conv.0.bias', 'model.point_backbone.encoder.second_conv.0.weight', 'model.point_backbone.encoder.second_conv.1.bias', 'model.point_backbone.encoder.second_conv.1.num_batches_tracked', 'model.point_backbone.encoder.second_conv.1.running_mean', 'model.point_backbone.encoder.second_conv.1.running_var', 'model.point_backbone.encoder.second_conv.1.weight', 'model.point_backbone.encoder.second_conv.3.bias', 'model.point_backbone.encoder.second_conv.3.weight', 'model.point_backbone.norm.bias', 'model.point_backbone.norm.weight', 'model.point_backbone.pos_embed.0.bias', 'model.point_backbone.pos_embed.0.weight', 'model.point_backbone.pos_embed.2.bias', 'model.point_backbone.pos_embed.2.weight', 'model.point_backbone.reduce_dim.bias', 'model.point_backbone.reduce_dim.weight', 'model.point_proj.0.bias', 'model.point_proj.0.weight', 'model.point_proj.2.bias', 'model.point_proj.2.weight', 'model.point_proj.4.bias', 'model.point_proj.4.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-18 13:48:55 - INFO - pointllm.train.train - LLM is fixed. Fix_llm flag is set to True
2025-06-18 13:48:55 - INFO - pointllm.train.train - Point backbone is fixed. Fix_pointnet flag is set to True, pointnet grad will not be recorded.
2025-06-18 13:48:55 - INFO - pointllm.train.train - Set requires_grad of point backbone to False
2025-06-18 13:48:55 - INFO - pointllm.train.train - Point projection layer is trainable.
2025-06-18 13:48:55 - INFO - stdout - Default point_backbone_ckpt is checkpoints/pc_encoder/point_model.pth.
2025-06-18 13:48:55 - ERROR - stderr - [rank0]: Traceback (most recent call last):
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:   File "/data/liweihong/code/RFT43D/PointLLM/pointllm/train/train_mem.py", line 13, in <module>
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:     train()
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:   File "/data/liweihong/code/RFT43D/PointLLM/pointllm/train/train.py", line 234, in train
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:     model.get_model().load_point_backbone_checkpoint(training_args.point_backbone_ckpt)
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:   File "/data/liweihong/code/RFT43D/PointLLM/pointllm/model/pointllm.py", line 158, in load_point_backbone_checkpoint
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:     self.point_backbone.load_checkpoint(self.config.point_backbone_ckpt if checkpoint_path is None else checkpoint_path)
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:   File "/data/liweihong/code/RFT43D/PointLLM/pointllm/model/pointbert/point_encoder.py", line 147, in load_checkpoint
2025-06-18 13:48:55 - ERROR - stderr - [rank0]:     for k, v in ckpt['state_dict'].items():
2025-06-18 13:48:55 - ERROR - stderr - [rank0]: KeyError: 'state_dict'
[rank0]:[W618 13:48:56.285526216 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
E0618 13:48:57.926000 1447468 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 1447530) of binary: /data/liweihong/miniconda3/envs/pointllm/bin/python3.10
Traceback (most recent call last):
  File "/data/liweihong/miniconda3/envs/pointllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/data/liweihong/miniconda3/envs/pointllm/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/data/liweihong/miniconda3/envs/pointllm/lib/python3.10/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/data/liweihong/miniconda3/envs/pointllm/lib/python3.10/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/data/liweihong/miniconda3/envs/pointllm/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/data/liweihong/miniconda3/envs/pointllm/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
pointllm/train/train_mem.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-18_13:48:57
  host      : node108
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1447530)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
(pointllm) liweihong@node108:~/code/RFT43D/PointLLM$ 